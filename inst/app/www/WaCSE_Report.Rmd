---
title: "Washington Climate Smart Estimator Report"
date: "**`r tools::toTitleCase(params$project)`** report generated by **`r tools::toTitleCase(params$name)`** on `r format(Sys.time(), ' %B %d, %Y')`"
geometry: "left=1cm,right=1cm,top=2cm,bottom=2cm"
mainfont: Arial
header-includes:
  - \usepackage{fancyhdr}
  - \usepackage{lipsum}
  - \pagestyle{fancy}
  - \fancyhead[LE, LO]{WaCSE reported generated on `r Sys.Date()`}
  - \fancyhead[RE, RO]{`r paste(tools::toTitleCase(params$name), tools::toTitleCase(params$project))`}

output: 
  pdf_document:
    latex_engine: xelatex
classoption: landscape
params: 
  name: NA
  project: NA
  table: NA
  summary: NA
  plot: NA
---

```{r setup, include = FALSE, echo=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(knitr)
library(kableExtra)
library(dplyr)
library(ggplot2)
```

```{r}

options(knitr.kable.NA = "Not estimated")

kbl_all <- kbl(params$table,
    col.names = c("MLRA",
                  "County",
                  "Class",
                  "Practice",
                  "Implementation",
                  "Acres",
                  "Carbon Dioxide",
                  "Nitrous Oxide",
                  "Methane",
                  "Total GHG"
                  ),
    caption = "Approximate Greenhouse Gas (GHG) Emission Reductions",
    align = "lllllrrrrr",
    format.args = list(big.mark = ","),
    escape = FALSE,
    booktabs = TRUE) %>%
  add_header_above(c(" " = 6, "(Metric tonnes CO2eq per year)" = 4), italic = TRUE) %>% 
  kable_styling(full_width = TRUE) %>%
  row_spec(row = 0, bold = TRUE) %>%
  column_spec(column = c(1:2), width = "0.8in") %>%
  column_spec(column = c(3:5), width = "1in") %>%
  column_spec(column = c(6:10), width = "0.8in") %>% 
  collapse_rows(columns = 1, valign = "top")

kbl_all

kbl_summary <- kbl(params$summary,
    col.names = c("MLRA",
                  "County",
                  "Unique Practice Implementations",
                  "Total Acres",
                  "Total GHG (MT CO2eq/yr)"
                  ),
    caption = "Summary of Total GHG Emission Reductions by County",
    align = "llrrr",
    format.args = list(big.mark = ","),
    escape = FALSE,
    booktabs = TRUE) %>%
  row_spec(row = 0, bold = TRUE) %>%
  column_spec(column = c(1:5), width = "1.2in") %>% 
  collapse_rows(columns = 1)

kbl_summary

```


```{r, fig.align = "center", fig.height = 6, fig.width= 10}

params$plot

```
